(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[419],{2779:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(4248),s=r(4564);function i(){let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(!0),[c,a]=(0,s.useState)(!1),[l,o]=(0,s.useState)(!1),[d,u]=(0,s.useState)(""),[x,m]=(0,s.useState)(""),[p,h]=(0,s.useState)({customer_name:"",customer_email:"",customer_phone:"",amount:"",currency:"INR",redirect_url:"",description:""});async function b(){try{let e=await fetch("/api/admin/invoices");if(e.ok){let r=await e.json();t(r.invoices||[])}}catch(e){console.error("Failed to fetch invoices:",e)}finally{i(!1)}}async function f(e){if(e.preventDefault(),u(""),m(""),o(!0),p.redirect_url)try{new URL(p.redirect_url)}catch(e){u("Invalid redirect URL"),o(!1);return}try{let e=await fetch("/api/admin/invoices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...p,amount_in_paise:Math.round(100*parseFloat(p.amount))})}),t=await e.json();e.ok?(m("Invoice created! Receipt: ".concat(t.invoice.receipt)),h({customer_name:"",customer_email:"",customer_phone:"",amount:"",currency:"INR",redirect_url:"",description:""}),a(!1),b()):u(t.error||"Failed to create invoice")}catch(e){u("Failed to create invoice")}finally{o(!1)}}return(0,s.useEffect)(()=>{b()},[]),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-zinc-900",children:"Invoices"}),(0,n.jsx)("p",{className:"text-zinc-600 mt-1",children:"Manage and create payment invoices"})]}),(0,n.jsxs)("button",{onClick:()=>a(!c),className:"px-6 py-3 bg-zinc-900 text-white font-semibold rounded-lg hover:bg-zinc-800 transition flex items-center gap-2",children:[(0,n.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Invoice"]})]}),d&&(0,n.jsx)("div",{className:"bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-lg",children:d}),x&&(0,n.jsx)("div",{className:"bg-emerald-50 border border-emerald-200 text-emerald-700 px-4 py-3 rounded-lg",children:x}),c&&(0,n.jsxs)("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-zinc-900 mb-6",children:"Create New Invoice"}),(0,n.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Customer Name *"}),(0,n.jsx)("input",{type:"text",value:p.customer_name,onChange:e=>h({...p,customer_name:e.target.value}),className:"w-full px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent outline-none",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Customer Email"}),(0,n.jsx)("input",{type:"email",value:p.customer_email,onChange:e=>h({...p,customer_email:e.target.value}),className:"w-full px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent outline-none"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Customer Phone"}),(0,n.jsx)("input",{type:"tel",value:p.customer_phone,onChange:e=>h({...p,customer_phone:e.target.value}),className:"w-full px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent outline-none"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Amount (in currency units) *"}),(0,n.jsx)("input",{type:"number",step:"0.01",min:"0",value:p.amount,onChange:e=>h({...p,amount:e.target.value}),className:"w-full px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent outline-none",placeholder:"100.00",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Currency *"}),(0,n.jsxs)("select",{value:p.currency,onChange:e=>h({...p,currency:e.target.value}),className:"w-full px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent outline-none",children:[(0,n.jsx)("option",{value:"INR",children:"INR - Indian Rupee"}),(0,n.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,n.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,n.jsx)("option",{value:"AED",children:"AED - UAE Dirham"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Redirect URL (after payment) *"}),(0,n.jsx)("input",{type:"url",value:p.redirect_url,onChange:e=>h({...p,redirect_url:e.target.value}),className:"w-full px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent outline-none",placeholder:"https://example.com/thank-you",required:!0})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Description"}),(0,n.jsx)("textarea",{value:p.description,onChange:e=>h({...p,description:e.target.value}),className:"w-full px-4 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent outline-none",rows:3,placeholder:"What is this invoice for?"})]}),(0,n.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,n.jsx)("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-zinc-900 text-white font-semibold rounded-lg hover:bg-zinc-800 transition disabled:opacity-50",children:l?"Creating...":"Create Invoice"}),(0,n.jsx)("button",{type:"button",onClick:()=>a(!1),className:"px-6 py-2 bg-zinc-100 text-zinc-900 font-semibold rounded-lg hover:bg-zinc-200 transition",children:"Cancel"})]})]})]}),(0,n.jsxs)("div",{className:"bg-white rounded-xl border border-zinc-200 shadow-sm overflow-hidden",children:[(0,n.jsx)("div",{className:"p-6 border-b border-zinc-200",children:(0,n.jsx)("h2",{className:"text-lg font-bold text-zinc-900",children:"All Invoices"})}),r?(0,n.jsx)("div",{className:"p-12 text-center text-zinc-500",children:"Loading..."}):0===e.length?(0,n.jsx)("div",{className:"p-12 text-center text-zinc-500",children:"No invoices yet. Create your first one!"}):(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-zinc-50 border-b border-zinc-200",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-zinc-600 uppercase tracking-wider",children:"Receipt"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-zinc-600 uppercase tracking-wider",children:"Customer"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-zinc-600 uppercase tracking-wider",children:"Amount"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-zinc-600 uppercase tracking-wider",children:"Status"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-zinc-600 uppercase tracking-wider",children:"Created"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-zinc-600 uppercase tracking-wider",children:"Actions"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-zinc-200",children:e.map(e=>{let t,r;return(0,n.jsxs)("tr",{className:"hover:bg-zinc-50 transition",children:[(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("div",{className:"font-mono text-sm font-medium text-zinc-900",children:e.receipt})}),(0,n.jsxs)("td",{className:"px-6 py-4",children:[(0,n.jsx)("div",{className:"text-sm font-medium text-zinc-900",children:e.customer_name||"—"}),e.customer_email&&(0,n.jsx)("div",{className:"text-xs text-zinc-500",children:e.customer_email})]}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("div",{className:"text-sm font-semibold text-zinc-900",children:(t=e.amount_in_paise,r=e.currency,new Intl.NumberFormat("en-IN",{style:"currency",currency:r||"INR"}).format(t/100))})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full border ".concat((e=>{switch(e){case"paid":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"draft":default:return"bg-zinc-100 text-zinc-800 border-zinc-200";case"issued":return"bg-blue-100 text-blue-800 border-blue-200";case"expired":return"bg-rose-100 text-rose-800 border-rose-200"}})(e.status)),children:e.status})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-zinc-600",children:e.created_at?new Date(e.created_at).toLocaleDateString():"—"}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,n.jsx)("a",{href:"/invoices?ref=".concat(e.receipt),target:"_blank",rel:"noopener noreferrer",className:"text-zinc-900 hover:text-zinc-600 font-medium",children:"View →"})})]},e.id)})})]})})]})]})}},6062:(e,t,r)=>{Promise.resolve().then(r.bind(r,2779))}},e=>{e.O(0,[647,516,358],()=>e(e.s=6062)),_N_E=e.O()}]);