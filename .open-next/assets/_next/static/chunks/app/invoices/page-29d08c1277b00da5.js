(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[175],{4895:(e,s,d)=>{"use strict";d.r(s),d.d(s,{default:()=>c});var t=d(4248),r=d(1975),i=d.n(r),n=d(4564),f=d(5519),a=d(423);function l(){var e,s;let d=(0,f.useSearchParams)().get("ref")||"",r=(0,n.useRef)(null),[a,l]=(0,n.useState)(d),[c,o]=(0,n.useState)(null),[x,m]=(0,n.useState)(!1),[b,u]=(0,n.useState)(!1),[j,h]=(0,n.useState)(null),[p,v]=(0,n.useState)(null);async function N(e){u(!0),h(null),o(null);try{let s=await fetch("/api/invoices/lookup?ref=".concat(encodeURIComponent(e)));if(!s.ok)throw Error("Invoice not found (".concat(s.status,")"));let d=await s.json();if(!d.invoice)throw Error("Invoice not found.");o(d.invoice)}catch(e){h((null==e?void 0:e.message)||"Could not find invoice.")}finally{u(!1)}}async function y(){if(c){m(!0),h(null),v(null);try{var e;v("Processing payment...");let s=await fetch("/api/invoices/pay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({receipt:c.receipt})});if(!s.ok)throw Error("Payment failed");let d=await s.json();(null==(e=d.invoice.notes)?void 0:e.redirect_url)?setTimeout(()=>{window.location.href=d.invoice.notes.redirect_url},1500):v("Payment processed successfully!")}catch(e){h((null==e?void 0:e.message)||"Payment failed"),m(!1)}}}(0,n.useEffect)(()=>{var e;null==(e=r.current)||e.focus();let s=e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key.toLowerCase()){var s;e.preventDefault(),null==(s=r.current)||s.focus()}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[]),(0,n.useEffect)(()=>{d&&N(d)},[]);let g=c&&"draft"===c.status,w=(null==c||null==(e=c.notes)?void 0:e.description)||"Invoice ".concat(null==c?void 0:c.receipt);return(0,t.jsxs)("main",{className:"jsx-fddd68b81e54fffe min-h-[100dvh] bg-[#F8F7F3] text-[#1C1C1C]",children:[(0,t.jsxs)("section",{className:"jsx-fddd68b81e54fffe mx-auto w-full max-w-4xl px-6 py-14",children:[(0,t.jsxs)("header",{className:"jsx-fddd68b81e54fffe mb-10",children:[(0,t.jsx)("p",{className:"jsx-fddd68b81e54fffe uppercase tracking-[0.2em] text-xs text-zinc-600",children:"Have an Invoice?"}),(0,t.jsx)("h1",{style:{fontFamily:"Coolvetica, system-ui, sans-serif"},className:"jsx-fddd68b81e54fffe mt-2 text-4xl sm:text-5xl font-semibold",children:"Pay your invoice"}),(0,t.jsx)("p",{className:"jsx-fddd68b81e54fffe mt-3 text-zinc-700 max-w-2xl",children:"Enter your invoice reference to fetch details securely and complete payment."})]}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe rounded-2xl border border-zinc-200 bg-white shadow-sm",children:[(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe p-5 sm:p-6 border-b border-zinc-200",children:[(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.trim()&&N(a.trim())},className:"jsx-fddd68b81e54fffe flex flex-col sm:flex-row gap-3",children:[(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe relative flex-1",children:[(0,t.jsx)("label",{htmlFor:"invoice-ref",className:"jsx-fddd68b81e54fffe sr-only",children:"Invoice reference"}),(0,t.jsx)("input",{ref:r,id:"invoice-ref",value:a,onChange:e=>l(e.target.value),placeholder:"e.g. LW-2025-0001",autoComplete:"off",inputMode:"text","aria-describedby":"invoice-help",className:"jsx-fddd68b81e54fffe w-full rounded-xl border border-zinc-300 bg-white px-4 py-3 outline-none ring-0 focus:border-zinc-900"}),(0,t.jsx)("span",{className:"jsx-fddd68b81e54fffe pointer-events-none absolute -bottom-[2px] left-2 right-2 h-[2px] bg-[#F4C3C2] rounded-full"})]}),(0,t.jsx)("button",{type:"submit",disabled:b||!a.trim(),className:"jsx-fddd68b81e54fffe rounded-xl px-5 py-3 font-medium tracking-wide bg-zinc-900 text-white hover:opacity-90 disabled:opacity-50",children:b?"Looking…":"Find invoice"})]}),(0,t.jsxs)("p",{id:"invoice-help",className:"jsx-fddd68b81e54fffe mt-2 text-xs text-zinc-500",children:["Tip: Press ",(0,t.jsx)("kbd",{className:"jsx-fddd68b81e54fffe px-1.5 py-0.5 rounded border",children:"⌘/Ctrl"}),"+",(0,t.jsx)("kbd",{className:"jsx-fddd68b81e54fffe px-1.5 py-0.5 rounded border",children:"K"})," to re-focus the box."]})]}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe p-5 sm:p-6",children:[j&&(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe mb-4 rounded-lg border border-rose-300 bg-rose-50 p-3 text-rose-800",children:j}),p&&(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe mb-4 rounded-lg border border-blue-300 bg-blue-50 p-4 text-blue-800",children:(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe flex items-center gap-3",children:[(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe animate-spin rounded-full h-5 w-5 border-b-2 border-blue-800"}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe",children:[(0,t.jsx)("p",{className:"jsx-fddd68b81e54fffe font-semibold",children:p}),(null==c||null==(s=c.notes)?void 0:s.redirect_url)&&(0,t.jsx)("p",{className:"jsx-fddd68b81e54fffe text-sm mt-1",children:"Redirecting you shortly..."})]})]})}),c?(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe grid gap-4 sm:grid-cols-[1.6fr_1fr]",children:[(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe rounded-xl border border-zinc-200 p-4 sm:p-5 bg-white",children:[(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe flex items-center justify-between gap-3",children:[(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe text-sm text-zinc-500",children:"Invoice Ref"}),(0,t.jsxs)("span",{title:"Status: ".concat(c.status),className:"jsx-fddd68b81e54fffe "+"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-medium ".concat((e=>{switch(e){case"paid":return"bg-emerald-100 text-emerald-800 border-emerald-300";case"draft":return"bg-amber-100 text-amber-900 border-amber-300";case"expired":return"bg-zinc-200 text-zinc-800 border-zinc-300";case"cancelled":return"bg-rose-100 text-rose-800 border-rose-300";default:return"bg-zinc-100 text-zinc-800 border-zinc-300"}})(c.status)),children:["● ",c.status]})]}),(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe mt-1 text-lg font-medium",children:c.receipt}),w&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe mt-4 text-sm text-zinc-500",children:"Description"}),(0,t.jsx)("p",{className:"jsx-fddd68b81e54fffe text-zinc-800",children:w})]}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe mt-4 space-y-3",children:[(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe",children:[(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe text-xs text-zinc-500",children:"Billed To"}),(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe font-medium break-words",children:c.customer_name||"—"})]}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe",children:[(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe text-xs text-zinc-500",children:"Email"}),(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe font-medium text-sm break-all",children:c.customer_email||"—"})]}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe",children:[(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe text-xs text-zinc-500",children:"Phone"}),(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe font-medium",children:c.customer_phone||"—"})]})]})]}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe rounded-xl border border-zinc-200 p-4 sm:p-5 bg-white relative overflow-hidden",children:[(0,t.jsx)("div",{style:{background:"radial-gradient(120% 80% at 100% 0%, #F4C3C2 0%, transparent 50%)"},className:"jsx-fddd68b81e54fffe pointer-events-none absolute inset-0 opacity-30"}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe relative",children:[(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe text-sm text-zinc-500",children:"Amount Due"}),(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe mt-1 text-3xl font-semibold",children:((e,s)=>{let d=(e/100).toFixed(2);return new Intl.NumberFormat(void 0,{style:"currency",currency:s||"INR",maximumFractionDigits:2}).format(parseFloat(d))})(c.amount_in_paise,c.currency)}),(0,t.jsxs)("div",{className:"jsx-fddd68b81e54fffe mt-2 text-xs text-zinc-600",children:["Currency: ",(0,t.jsx)("span",{className:"jsx-fddd68b81e54fffe font-medium",children:c.currency})]}),g?(0,t.jsxs)("button",{onClick:y,disabled:x,className:"jsx-fddd68b81e54fffe mt-5 w-full rounded-xl bg-[#1C1C1C] text-white py-3 font-medium hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[x&&(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),x?"Processing payment...":"Pay securely"]}):(0,t.jsx)("div",{className:"jsx-fddd68b81e54fffe mt-5 rounded-lg border border-amber-300 bg-amber-50 px-3 py-2 text-amber-800",children:"paid"===c.status?"⚠️ This invoice has already been paid.":"Payments are not available: ".concat(c.status,".")})]})]})]}):(0,t.jsx)("p",{className:"jsx-fddd68b81e54fffe text-sm text-zinc-500",children:"Enter a reference above to fetch invoice details."})]})]}),(0,t.jsx)("p",{className:"jsx-fddd68b81e54fffe mt-6 text-xs text-zinc-500",children:"By paying, you agree to the quoted scope and our standard terms."})]}),(0,t.jsx)(i(),{id:"fddd68b81e54fffe",children:":root{--lw-bg:#F8F7F3;--lw-ink:#1C1C1C;--lw-accent:#F4C3C2}kbd{background:#fff;border-color:#d4d4d8}"})]})}function c(){return(0,t.jsx)(a.A,{children:(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)("main",{className:"min-h-[100dvh] bg-[#F8F7F3] text-[#1C1C1C] flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-zinc-900 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-zinc-600",children:"Loading invoice page..."})]})}),children:(0,t.jsx)(l,{})})})}},6248:(e,s,d)=>{Promise.resolve().then(d.bind(d,4895))}},e=>{e.O(0,[596,909,9,647,516,358],()=>e(e.s=6248)),_N_E=e.O()}]);